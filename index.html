<!DOCTYPE html> 
<html lang="en"> 
	<head> 
		<meta charset="UTF-8" />
		<title>Stockheimer</title>
		<link rel="stylesheet" href="css/ui.css" />
	</head>
	<body>
		<div class="loading-text">
			Loading...
		</div>
		<div id="game-div">
			<div class="scene-root hide" id="lobby-scene-root">					
				<div class="game-title">
					Stockheimer
				</div>
				<div id="user-name-container">
					<div class="form-text" id="player-text">Player Name:</div>
					<input type="text" class="form-input" id="user-name" maxlength="32" />
					<input type="button" class="form-button" id="player-submit" value="Play" onclick="window.dispatchEvent(new CustomEvent('player-submit-click'));"/>
					<input type="button" class="form-button hide" id="player-submit-existing" value="Play with existing user" onclick="window.dispatchEvent(new CustomEvent('player-submit-click'));"/>
					<input type="button" class="form-button hide" id="player-new" value="Delete existing user" onclick="window.dispatchEvent(new CustomEvent('player-new-click'));"/>
				</div>
				<div id="game-server-details">
					<div id="game-server-details-players">Players:</div>
				</div>
				<div class="lobby-panel">
					<div class="info-container">
						<img class="brief-controls" src="assets/images/brief-controls.png" />
					</div>
				</div>
				<div class="lobby-panel">
					<div class="info-container">
						<h1>
							Brief Explanation
						</h1>
						<div class="lobby-panel-section">
							<div class="lobby-panel-text">Stockheimer is a PvP multiplayer game.</div>
							<div class="lobby-panel-text">
								*** This is currently built as a "tech demo" and is a work in progress.
							</div>
						</div>
						
						<div class="lobby-panel-section">
							<div class="lobby-panel-title">
								Links
							</div>
							<div class="lobby-panel-text">
								Dev Blog - <a href="https://dontcodethis.com" target="_blank">https://dontcodethis.com</a>
							</div>
							<div class="lobby-panel-text">
								Twitch - <a href="https://twitch.tv/miles_gloriosus" target="_blank">https://twitch.tv/miles_gloriosus</a>
							</div>
							<div class="lobby-panel-text">
								Github - <a href="https://github.com/esnyder232/stockheimer" target="_blank">https://github.com/esnyder232/stockheimer</a>
							</div>
						</div>
						<div id="change-log">

						</div>
					</div>
				</div>
				
			</div>
			<div class="scene-root hide" id="user-connecting-scene-root">
				<input type="button" id="exit-game" value="Exit" onclick="window.dispatchEvent(new CustomEvent('exit-game-click'));" />
				<h1 id="connecting-message">Initializing...</h1>
				<div id="connecting-error-list">

				</div>
				<div class="hide" id="connecting-error-item-template">
					
				</div>
			</div>
			<div class="scene-root ignore-pointer-events hide" id="main-scene-root">
				<div class="hide menu-wrapper" id="team-menu">
					<div class="menu-container">
						<div class="menu-close-container">
							<div class="menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-team-menu'));">
								<img class="menu-close-button" src="assets/images/x-mark.png" />
							</div>
						</div>
						<div class="menu-title">
							<span>Join a Team</span>
						</div>
						<div class="team-button-container" id="team-button-container">

							<input type="button" class="hide menu-button" id="join-team-buttom-template" value="???"/>
						</div>
					</div>		
				</div>

				<div class="hide menu-wrapper" id="character-class-menu">
					<div class="menu-container">
						<div class="menu-close-container">
							<div class="menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-character-class-menu'));">
								<img class="menu-close-button" src="assets/images/x-mark.png" />
							</div>
						</div>
						<div class="menu-title">
							<span>Pick a class</span>
						</div>
						<div class="team-button-container" id="character-class-button-container">

							<input type="button" class="hide menu-button" id="character-class-buttom-template" value="???"/>
						</div>
					</div>		
				</div>


				<div class="hide small-menu-wrapper" id="chat-menu">
					<div class="small-menu-container chat-menu-container">
						<div class="small-menu-close-container">
							<div class="small-menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-chat-menu'));">
								<img class="small-menu-close-button" src="assets/images/x-mark.png" />
							</div>
						</div>
						<div class="small-menu-contents chat-menu-contents">
							<div class="chat-history" id="chat-history">
								<div class="chat-history-item hide" id="chat-history-item-template">
									<span class="chat-history-ts" name="chat-history-ts"></span>
									<span class="chat-history-name" name="chat-history-name"></span>
									<span class="chat-history-msg" name="chat-history-msg"></span>
								</div>
							</div>
							<div class="chat-input-container">
								<input type="text" class="tb-chat-input" id="tb-chat-input" placeholder="Chat message" maxlength="400"/>
								<input type="button" class="tb-chat-submit" id="tb-chat-submit" value="Chat" onclick="window.dispatchEvent(new CustomEvent('tb-chat-submit-click'));" />
							</div>
						</div>
					</div>
				</div>

				<div class="small-menu-wrapper-center" id="user-list-menu">
					<div class="small-menu-container-center user-list-menu-container">
						<div class="small-menu-close-container">
							<div class="small-menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-user-list-menu'));">
								<img class="small-menu-close-button" src="assets/images/x-mark.png" />
							</div>
						</div>
						<div class="small-menu-contents user-list-menu-contents">
							<div class="user-list-game-summary">
								<div class="user-list-game-type" id="user-list-game-type">
									Elimination
								</div>
								<div class="user-list-game-rules" id="user-list-game-rules">
									First to 5 round wins.
								</div>
							</div>

							<div class="user-list-team-container" id="user-list-team-container">

							</div>
							
							<div class="hide user-list-team-contents" id="user-list-team-contents-template">
								<div class="team-title" name="team-title"> 
									Team name Here
								</div>
								<div class="team-pair"> 
									<div class="team-pair-label">
										Players
									</div>
									<div class="team-pair-value" name="team-num-players">
										0
									</div>
								</div>
								<div class="team-pair"> 
									<div class="team-pair-label">
										Wins
									</div>
									<div class="team-pair-value" name="team-round-wins">
										0
									</div>
								</div>
								<div class="team-pair"> 
									<div class="team-pair-label">
										Points
									</div>
									<div class="team-pair-value" name="team-round-points">
										0
									</div>
								</div>

								<div class="user-list-team-body">
									<table class="ul-table">
										<thead>
											<tr class="ul-head">
												<th class="ul-ping-header">Ping</th>
												<th class="ul-name-header">Name</th>
												<th class="ul-points-header">Points</th>
												<th class="ul-deaths-header">Deaths</th>
											</tr>
										</thead>
										<tbody id="ul-tbody" name="ul-tbody">
																						
										</tbody>
										<tfoot>
											<tr class="hide ul-tr" id="ul-item-template">
												<td class="ul-ping-value" name="ul-ping-value"></td>
												<td class="ul-name-value" name="ul-name-value"></td>
												<td class="ul-points-value" name="ul-points-value"></td>
												<td class="ul-deaths-value" name="ul-deaths-value"></td>
											</tr>
										</tfoot>
									</table>
								</div>
							</div>
						</div>
						<div class="user-list-footer">
							<div class="user-list-player-count" id="user-list-player-count">Players: 0/32</div>
							<div class="user-list-spectator-container">
								<div class="user-list-spectator-title">
									Spectators:
								</div>
								<div class="user-list-spectator-list" id="user-list-spectator-list">
									
								</div>
								<div class="user-list-spectator-item" id="user-lists-spectator-item-template"></div>
							</div>
							
						</div>
					</div>
				</div>


				<div class="ui-list-container chat-menu-minified-container" id="chat-menu-minified">
					<div class="ui-list-contents chat-menu-minified-contents">
						<div class="chat-history-minified-wrapper">
							<div class="chat-history-minifed" id="chat-history-minified">
								<div class="chat-history-minified-item invisible" id="chat-history-minified-item-template">
									<div class="chat-history-minified-item-inner-wrapper">
										<span class="chat-history-ts" name="chat-history-minified-ts"></span>
										<span class="chat-history-name" name="chat-history-minified-name"></span>
										<span class="chat-history-msg" name="chat-history-minified-msg"></span>	
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>


				<div class="round-menu-wrapper" id="round-menu">
					<div class="round-timer-container" id="round-timer">
						12:00
					</div>
					<div class="round-state-container" id="round-state">
						Setup
					</div>
				</div>

				<div class="respawn-menu-wrapper" id="respawn-menu">
					<div class="respawn-message-container" id="respawn-message">
						hello
					</div>
				</div>


				<div class="ui-list-container kill-feed-menu-container" id="kill-feed-menu">
					<div class="ui-list-contents kill-feed-contents">
						<div class="kill-feed-history" id="kill-feed-history">
							<div class="kill-feed-item hide" id="kill-feed-item-template">
								<div class="kill-feed-item-inner-wrapper" name="kill-feed-item-inner-wrapper">
									<span name="kill-feed-killer"></span>
									<span name="kill-feed-action">killed</span>
									<span name="kill-feed-victim"></span>
								</div>
							</div>
						</div>
					</div>
				</div>

				

				<div class="ui-list-container team-score-menu-container" id="team-score-menu">
					<div class="ui-list-contents team-score-contents">
						<div class="team-score-title" id="team-score-title">
							Team Scores:
						</div>
						<div class="team-score-list" id="team-score-list">

						</div>
						<div class="team-score-item hide" id="team-score-item-template">
						</div>
					</div>
				</div>



				<div class="hide small-menu-wrapper">
					<div class="small-menu-container chat-menu-container">
						<div class="small-menu-close-container">
							<div class="small-menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-chat-menu'));">
								<img class="small-menu-close-button" src="assets/images/x-mark.png" />
							</div>
						</div>
						<div class="small-menu-contents chat-menu-contents">
							<div class="chat-history" id="chat-history">
								<div class="chat-history-item hide" id="chat-history-item-template">
									<span class="chat-history-ts" name="chat-history-ts"></span>
									<span class="chat-history-name" name="chat-history-name"></span>
									<span class="chat-history-msg" name="chat-history-msg"></span>
								</div>
							</div>
							<div class="chat-input-container">
								<input type="text" class="tb-chat-input" id="tb-chat-input" placeholder="Chat message" maxlength="400"/>
								<input type="button" class="tb-chat-submit" id="tb-chat-submit" value="Chat" onclick="window.dispatchEvent(new CustomEvent('tb-chat-submit-click'));" />
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="hide menu-wrapper" id="main-menu">
				<div class="menu-container">
					<div class="menu-close-container">
						<div class="menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-main-menu'));">
							<img class="menu-close-button" src="assets/images/x-mark.png" />
						</div>
					</div>
					<div class="menu-title">
						<span>Main Menu</span>
					</div>
					<div class="team-button-container" id="team-button-container">
						<input type="button" class="menu-button" value="Exit Server" id="main-menu-exit-server-button" onclick="window.dispatchEvent(new CustomEvent('exit-game-click'));"/>
					</div>
				</div>		
			</div>

			<div class="hide debug-menu-wrapper" id="debug-menu">
				<div class="debug-menu-container debug-log-container">
					<div class="debug-menu-contents debug-log-contents">
						<div class="debug-title">Debug Log</div>
						<div class="debug-log" id="debug-log" readonly></div>
					</div>
				</div>

				<div class="debug-menu-container debug-input-container">
					<div class="debug-menu-contents debug-input-contents">
						<div class="debug-title">Input Information:</div>
						<div id="debug-x"></div>
						<div id="debug-y"></div>
						<div id="debug-is-down"></div>
						<div id="debug-angle"></div>
					</div>
				</div>
				<div class="debug-menu-container debug-ai-container">
					<div class="debug-menu-contents debug-ai-contents" id="debug-ai-contents">
						<div class="debug-title">Debug Controls:</div>
						<div class="hide" id="display-server-sightlines-container">
							<input type="checkbox" id="display-server-sightlines"/>
							<span> Display Server Sightlines</span>
						</div>
						
						<input type="button" class="hide" id="spawn-ai-button-template" value="???"/>
						<input type="button" class="hide" id="kill-random-ai-button-template" value="???"/>
						<input type="button" class="hide" id="kill-all-ai-button-template" value="???"/>
					</div>
				</div>
			</div>

			<div class="hide round-start-wrapper" id="round-start-menu">
				<div class="round-start-container">
					<div class="round-start-gametype" id="round-start-gametype">
						Deathmatch
					</div>
					<div class="round-start-rules" id="round-start-rules">
						First to 5 wins
					</div>
					<div class="round-start-round-num" id="round-start-round-num">
						Round 1
					</div>
				</div>
			</div>

			<div class="hide match-win-text-wrapper" id="match-win-text">
				<div class="match-win-text-container">
					<div class="match-win-text-title" id="match-win-text-title">
						Blue Team Wins the match!
					</div>
					<div class="match-win-text-rules" id="match-win-text-rules">
						Deathmatch: first to 5 wins
					</div>
				</div>
			</div>


			<div class="hide round-results-menu-wrapper" id="round-results-menu">
				<div class="round-results-menu-container">
					<div class="menu-close-container">
						<div class="menu-close-button" onclick="window.dispatchEvent(new CustomEvent('close-round-results-menu'));">
							<img class="menu-close-button" src="assets/images/x-mark.png" />
						</div>
					</div>
					<div class="menu-title">
						<span>Round results:</span>
					</div>
					<div class="round-results-winner" id="round-results-winner">
					</div>
					<div class="round-results-mvp-title">
						<span>Team Standings:</span>
					</div>
					<div class="round-results-game-rules" id="round-results-game-rules">
						(Elimination: First to 5 rounds)
					</div>
					<div class="round-results-standings" id="round-results-standings">
						
					</div>
					<div class="hide round-results-standings-item" id="round-results-standings-item-template">
						<div class="round-results-standings-team" name="round-results-standings-team">
							Team name here
						</div>
						<div class="round-results-standings-wins" name="round-results-standings-wins">
							123
						</div>
					</div>

					<div class="round-results-mvp-container">
						<div class="round-results-mvp-title">
							<span>Round Best Players:</span>
						</div>
						<table class="mvp-table">
							<thead>
								<tr class="mvp-th">
									<th class="mvp-team-header">Team</th>
									<th class="mvp-name-header">Name</th>
									<th class="mvp-points-header">Kills</th>
									<th class="mvp-deaths-header">Deaths</th>
									<th class="mvp-heals-header">Heals</th>
								</tr>
							</thead>
							<tbody id="mvp-best-tbody">
							</tbody>
							<tfoot>
								<tr class="hide mvp-tr" id="mvp-item-template">
									<td class="mvp-team-value" name="mvp-team-value"></td>
									<td class="mvp-name-value" name="mvp-name-value"></td>
									<td class="mvp-points-value" name="mvp-points-value"></td>
									<td class="mvp-deaths-value" name="mvp-deaths-value"></td>
									<td class="mvp-heals-value" name="mvp-heals-value"></td>
								</tr>
							</tfoot>
						</table>
					</div>

					<div class="round-results-mvp-container">
						<div class="round-results-mvp-title">
							<span>Round Worst Players:</span>
						</div>
						<table class="mvp-table">
							<thead>
								<tr class="mvp-th">
									<th class="mvp-team-header">Team</th>
									<th class="mvp-name-header">Name</th>
									<th class="mvp-points-header">Points</th>
									<th class="mvp-deaths-header">Deaths</th>
									<th class="mvp-heals-header">Heals</th>
								</tr>
							</thead>
							<tbody id="mvp-worst-tbody">
							</tbody>
						</table>
					</div>
				</div>		
			</div>



			<div class="quick-menu-wrapper">
				<div class="quick-menu" id="quick-menu">
					<div class="quick-menu-container">
						<img class="quick-menu-icon" id="quick-menu-main-menu" src="assets/images/white-gear-icon4.png" onclick="window.dispatchEvent(new CustomEvent('toggle-main-menu'));"/>
						<img class="hide quick-menu-icon" id="quick-menu-team" src="assets/images/flag-red.png" onclick="window.dispatchEvent(new CustomEvent('toggle-team-menu'));"/>
						<img class="hide quick-menu-icon" id="quick-menu-character-class" src="assets/images/sword-brandish.png" onclick="window.dispatchEvent(new CustomEvent('toggle-character-class-menu'));"/>
						<img class="hide quick-menu-icon" id="quick-menu-chat" src="assets/images/chat-bubble-gray.png" onclick="window.dispatchEvent(new CustomEvent('toggle-chat-menu'));"/>
						<img class="hide quick-menu-icon" id="quick-menu-user-list" src="assets/images/person-gray.png" onclick="window.dispatchEvent(new CustomEvent('toggle-user-list-menu'));"/>
						<img class="quick-menu-icon" id="quick-menu-debug" src="assets/images/command-console-black.png" onclick="window.dispatchEvent(new CustomEvent('toggle-debug-menu'));"/>
					</div>
				</div>
			</div>


			<div class="hide modal-wrapper" id="modal-menu">
				<div class="menu-container">
					<div class="menu-title">
						<span id="modal-title">Error</span>
					</div>
					<div class="modal-info" id="modal-info">
						???
					</div>
					<input type="button" class="menu-button" value="Okay" onclick="window.dispatchEvent(new CustomEvent('close-modal-menu'));"/>
				</div>
			</div>

			<div class="hide modal-wrapper" id="confirm-menu">
				<div class="menu-container">
					<div class="menu-title">
						<span id="confirm-title">Confirm?</span>
					</div>
					<div class="confirm-info" id="confirm-info">
						Are you sure?
					</div>
					<input type="button" class="menu-button" value="Confirm" id="confirm-button" onclick="window.dispatchEvent(new CustomEvent('confirm-menu-yes'));"/>
					<input type="button" class="menu-button" value="Cancel" id="cancel-button" onclick="window.dispatchEvent(new CustomEvent('confirm-menu-no'));"/>
				</div>
			</div>
		</div>
	</body>

	<script id="team-shader" type="notjs">
		precision mediump float;
		uniform sampler2D uMainSampler;
		varying vec2 outTexCoord;
		uniform vec2 uResolution;

		vec4 replaceColor(vec4 originalColor, vec4 colorToReplace, vec4 newColor) {
			vec4 finalColor = originalColor;
			
			int rCoef = 1 - int(min(1.0, abs(colorToReplace.r*255.0 - originalColor.r*255.0)));
			int gCoef = 1 - int(min(1.0, abs(colorToReplace.g*255.0 - originalColor.g*255.0)));
			int bCoef = 1 - int(min(1.0, abs(colorToReplace.b*255.0 - originalColor.b*255.0)));
			int aCoef = 1 - int(min(1.0, abs(colorToReplace.a*255.0 - originalColor.a*255.0)));
			
			//finalCoef will only ever be 1 or 0.
			int finalCoef = (rCoef + gCoef + bCoef + aCoef) / 4;
			
			finalColor = (originalColor*(float(1-finalCoef))) + (newColor*(float(finalCoef)));
			
			
			return finalColor;
		}
		
		void main( void ) {	
			// taem color swap
			// testing
			/*
			const vec4 primaryColorToReplace = vec4(55.0/255.0, 148.0/255.0, 110.0/255.0, 255.0/255.0);
			const vec4 primaryColorNewColor = vec4(255.0/255.0, 255.0/255.0, 0.0/255.0, 50.0/255.0);
			
			const vec4 secondaryColorToReplace = vec4(106.0/255.0, 190.0/255.0, 48.0/255.0, 255.0/255.0);
			const vec4 secondaryColorNewColor = vec4(0.0/255.0, 0.0/255.0, 255.0/255.0, 50.0/255.0);
			*/
			
			const vec4 primaryColorToReplace = #primaryColorToReplace#;
			const vec4 primaryColorNewColor = #primaryColorNewColor#;
			
			const vec4 secondaryColorToReplace = #secondaryColorToReplace#;
			const vec4 secondaryColorNewColor = #secondaryColorNewColor#;
			
			
			vec4 finalColor = texture2D(uMainSampler, outTexCoord);

			finalColor = replaceColor(finalColor, primaryColorToReplace, primaryColorNewColor);
			finalColor = replaceColor(finalColor, secondaryColorToReplace, secondaryColorNewColor);
				
			gl_FragColor = finalColor;
		}
	</script>



	<script id="projectile-shader" type="notjs">
		precision mediump float;
		uniform sampler2D uMainSampler;
		varying vec2 outTexCoord;
		uniform vec2 uResolution;

		vec4 replaceColor(vec4 originalColor, vec4 colorToReplace, vec4 newColor) {
			vec4 finalColor = originalColor;
			
			//check on the r value this time for efficiency reasons
			int rCoef = 1 - int(min(1.0, abs(colorToReplace.r*255.0 - originalColor.r*255.0)));
						
			//finalColor = (originalColor*(float(1-rCoef))) + (newColor*(float(rCoef)));
			
			float finalR = originalColor.r*float(1-rCoef) + newColor.r*(float(rCoef));
			float finalG = originalColor.g*float(1-rCoef) + newColor.g*(float(rCoef));
			float finalB = originalColor.b*float(1-rCoef) + newColor.b*(float(rCoef));
			float finalA = originalColor.a*float(1-rCoef) + newColor.a*(float(rCoef));

			//float finalR = 255.0/255.0;
			//float finalG = 0.0/255.0;
			//float finalB = 0.0/255.0;
			//float finalA = 1.0/255.0;
			
			finalColor = vec4(finalR, finalG, finalB, finalA);
			
			return finalColor;
		}
		
		void main( void ) {	
			// taem color swap
			// testing
			/*
			const vec4 primaryColorToReplace = vec4(55.0/255.0, 148.0/255.0, 110.0/255.0, 255.0/255.0);
			const vec4 primaryColorNewColor = vec4(255.0/255.0, 255.0/255.0, 0.0/255.0, 50.0/255.0);
			
			const vec4 secondaryColorToReplace = vec4(106.0/255.0, 190.0/255.0, 48.0/255.0, 255.0/255.0);
			const vec4 secondaryColorNewColor = vec4(0.0/255.0, 0.0/255.0, 255.0/255.0, 50.0/255.0);
			*/
			
			const vec4 color1ToReplace = #color1ToReplace#;
			const vec4 color1NewColor = #color1NewColor#;
			
			const vec4 color2ToReplace = #color2ToReplace#;
			const vec4 color2NewColor = #color2NewColor#;

			const vec4 color3ToReplace = #color3ToReplace#;
			const vec4 color3NewColor = #color3NewColor#;
			
			const vec4 color4ToReplace = #color4ToReplace#;
			const vec4 color4NewColor = #color4NewColor#;
			
			
			vec4 finalColor = texture2D(uMainSampler, outTexCoord);

			finalColor = replaceColor(finalColor, color1ToReplace, color1NewColor);
			finalColor = replaceColor(finalColor, color2ToReplace, color2NewColor);
			finalColor = replaceColor(finalColor, color3ToReplace, color3NewColor);
			finalColor = replaceColor(finalColor, color4ToReplace, color4NewColor);
				
			gl_FragColor = finalColor;
		}
	</script>

	
	<!--#BUNDLES_START#-->
	<script src="client-dist/app.bundle.js"></script>
	<!--#BUNDLES_END#-->
</html>